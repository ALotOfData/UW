---
title: "DATA557 - Team Project"
author: "Will Wright"
date: "February 24, 2019"
output: pdf_document
---

```{r setup, include=FALSE}
########################################################################################################################
# LOAD LIBRARIES
########################################################################################################################
library(dplyr)
library(lubridate)

########################################################################################################################
# READ DATA
########################################################################################################################
setwd("~/UW/DATA557/TEAM-PROJECT/") 
crimeData_raw <- read.csv("Crime_Data.csv") #514,152 rows
incomeData <- read.csv("seattle_medianIncome_cleaned.csv")
```

```{r cleaning, echo = FALSE}
########################################################################################################################
# CLEAN DATA
########################################################################################################################

crimeData <- crimeData_raw
crimeData$Occurred.Date <- as_date(as.character(crimeData$Occurred.Date), format = "%m/%d/%Y", tz = "UTC")
crimeData$Reported.Date <- as_date(as.character(crimeData$Reported.Date), format = "%m/%d/%Y", tz = "UTC")

crimeData <- crimeData %>%
  mutate(reportedYear = year(crimeData$Reported.Date),
         occurredYear = year(crimeData$Occurred.Date),
         reportedMonth = month(crimeData$Reported.Date),
         occurredMonth = month(crimeData$Occurred.Date))

# clean NAs (commented out parts for EDA, but can be used to explore for same results)
# naSummer <- function(column_input) sum(is.na(column_input))
# apply(crimeData, 2, naSummer)
# # show data with NAs
# rbind(crimeData[which(is.na(crimeData$Reported.Date)),],
#       crimeData[which(is.na(crimeData$Occurred.Date)),])
#   

# set rows with NA values aside and remove
crimeData_nas <- crimeData[which(is.na(crimeData$Reported.Time)),]
crimeData <- na.omit(crimeData) #514,150 rows (2 omitted)

# filter to only the decade of 2009 through 2018
crimeData <- crimeData[which(crimeData$occurredYear>=2009 & crimeData$occurredYear <2019),] #464,023 (50,127 more omitted)

# join on median income data after converting neighborhood in each dataset to character class
incomeData$crimeData_neighborhood <- as.character(incomeData$crimeData_neighborhood)

crimeData_income <- crimeData %>%
  mutate(Neighborhood = as.character(Neighborhood)) %>%
  left_join(incomeData[,2:3], by = c("Neighborhood" = "crimeData_neighborhood")) %>%
  na.omit() #461,200 rows (omitted 2823 rows with "UNKNOWN" neighborhood)

```


